<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Background · FlexJuMP.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>FlexJuMP.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li class="current"><a class="toctext" href="background.html">Background</a><ul class="internal"><li><a class="toctext" href="#System-Characterization-1">System Characterization</a></li><li><a class="toctext" href="#Stochastic-Flexibility-Index-Problem-1">Stochastic Flexibility Index Problem</a></li><li><a class="toctext" href="#Flexibility-Index-Problem-1">Flexibility Index Problem</a></li><li><a class="toctext" href="#Uncertainty-Set-Characterization-1">Uncertainty Set Characterization</a></li><li><a class="toctext" href="#Analysis-Techniques-1">Analysis Techniques</a></li></ul></li><li><a class="toctext" href="guide.html">User Guide</a></li><li><a class="toctext" href="examples.html">Examples</a></li><li><a class="toctext" href="api.html">Library</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="background.html">Background</a></li></ul><a class="edit-page" href="https://github.com/pulsipher/FlexJuMP.jl/blob/master/docs/src/background.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Background</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Background-1" href="#Background-1">Background</a></h1><p>This page provides a background on the theory and methods that form the computational framework that is implemented by FlexJuMP to quantify and analyze system flexibility. This is not a rigorous or complete review and more information is provided <a href="https://docs.google.com/a/wisc.edu/viewer?a=v&amp;pid=sites&amp;srcid=d2lzYy5lZHV8emF2YWxhYnxneDo3MDJkNmFhMDc0MGRlY2Qz">here</a></p><h2><a class="nav-anchor" id="System-Characterization-1" href="#System-Characterization-1">System Characterization</a></h2><p>We consider general systems that are subjected to random variation and attempt to counteract it via recourse (if there is recourse). We characterize these systems as having random variables <span>$\boldsymbol{\theta} \in \mathbb{R}^{n_{\theta}}$</span>, recourse variables <span>$\mathbf{z} \in \mathbb{R}^{n_{z}}$</span>, state variables <span>$\mathbf{x} \in \mathbb{R}^{n_{x}}$</span>, equality constraints <span>$h_i(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) = 0, \, i \in I,$</span> and inequality constraints <span>$f_j(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) \leq 0, \, j \in J$</span>. The feasibility (meaning there exists recourse to satisfy the system constraints) of a particular instance of <span>$\boldsymbol{\theta}$</span> is evaluated via the feasibility function <span>$\psi(\boldsymbol{\theta})$</span> which is</p><div>\[\begin{equation}
	\begin{aligned}
		&amp;\psi(\boldsymbol{\theta}) = &amp;\min_{\mathbf{z}, \mathbf{x}, u \in \mathbb{R}} &amp;&amp;&amp; u \\
		&amp;&amp;\text{s.t.} &amp;&amp;&amp; f_j(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) \leq u, &amp; j \in J \\
		&amp;&amp;&amp;&amp;&amp; h_i(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) = 0, &amp; i \in I
	\end{aligned}
\end{equation}\]</div><p>where <span>$\boldsymbol{\theta}$</span> is feasible if <span>$\psi(\boldsymbol{\theta}) \leq 0$</span>. This feasible function is what the <a href="api.html#FlexJuMP.ismeanfeasible"><code>ismeanfeasible</code></a> and <a href="api.html#FlexJuMP.findstochasticflexibility"><code>findstochasticflexibility</code></a> functions use to evaluate feasibility of particular instances of <span>$\boldsymbol{\theta}$</span>. The set of all feasible instances of <span>$\boldsymbol{\theta}$</span> forms the feasible region <span>$\Theta := \{\boldsymbol{\theta}\,:\,\psi(\boldsymbol{\theta}) \leq 0\}$</span> which is illustrated below.</p><p><img src="images/feasible_region.png" alt="feasible_region"/></p><h2><a class="nav-anchor" id="Stochastic-Flexibility-Index-Problem-1" href="#Stochastic-Flexibility-Index-Problem-1">Stochastic Flexibility Index Problem</a></h2><p>The stochastic flexibility index <span>$SF$</span> is a flexibility metric for systems that are subjected to uncertain parameters (e.g., disturbances, physical parameters) that are modeled as random variables, and is defined as the probability of finding recourse to maintain feasible operation. This can be computed by integrating the probability density function <span>$p:\mathbb{R}^{n_{\theta}}\to \mathbb{R}$</span> of the random parameters over the feasible region:</p><div>\[\begin{equation}
	SF := \int_{\boldsymbol{\theta}\in\Theta} p(\boldsymbol{\theta}) d\boldsymbol{\theta} = \mathbb{P}\left( \psi(\boldsymbol{\theta}) \leq 0 \right).
\end{equation}\]</div><p>This is illustrated below for a multivariate Gaussian distribution.</p><p><img src="images/sf_index.png" alt="sf_index"/></p><p>The <span>$SF$</span> index can be computed rigorously via Monte Carlo (MC) sampling. This is done by assessing the feasibility of each realization. Such an approach converges exponentially with the number of MC samples but typically requires a very large number of samples leading to scalability issues. One possible alternative is to estimate the stochastic vulnerability index <span>$SV := 1 - SF$</span> which can be determined by incorporating all of the MC samples in one large linear program:</p><div>\[\begin{equation}
\begin{aligned}
&amp;&amp;\min_{\mathbf{z}^k, \mathbf{x}^k, y^k \in \mathbb{R}} &amp;&amp;&amp; \frac{1}{K} \sum_{k = 1}^{K} y^k \\
&amp;&amp;\text{s.t.} &amp;&amp;&amp; f_j(\mathbf{z}^k, \mathbf{x}^k, \boldsymbol{\theta}^k) \leq y^k, &amp; j \in J, \ \ k = [1, K] \\
&amp;&amp;&amp;&amp;&amp; h_i(\mathbf{z}^k, \mathbf{x}^k, \boldsymbol{\theta}^k) = 0, &amp; i \in I, \ \ k = [1,K] \\
&amp;&amp;&amp;&amp;&amp; y^k \geq 0 &amp; k = [1,K]
\end{aligned}
\end{equation}\]</div><p>where <span>$K$</span> is the number of samples. The sampled value of <span>$SV$</span> is then obtained by:</p><div>\[\begin{equation}
SV = \frac{1}{K} \sum_{k = 1}^{K} \mathbb{1}_{\mathbb{R}_{&gt;0}}(y^{k*}).
\end{equation}\]</div><p>The function <a href="api.html#FlexJuMP.findstochasticflexibility"><code>findstochasticflexibility</code></a> employs both of these techniques estimate the <span>$SF$</span> index via MC sampling.</p><h2><a class="nav-anchor" id="Flexibility-Index-Problem-1" href="#Flexibility-Index-Problem-1">Flexibility Index Problem</a></h2><p>The so-called flexibility index problem provides a more scalable approach to quantifying flexibility. This approach seeks to identify the largest uncertainty set <span>$T(\delta)$</span> (where <span>$\delta \in \mathbb{R}_+$</span> is a parameter that scales <span>$T$</span>) for which the system remains feasible. In other words, we seek to find the largest uncertainty set under which there exists recourse to recover feasibility. The flexibility index <span>$F$</span> is defined as:</p><div>\[\begin{equation}
	\begin{aligned}
		&amp; F := &amp; \max_{\delta\in\mathbb{R}_+} &amp;&amp;&amp;\delta \\
		&amp;&amp;\text{s.t.} &amp;&amp;&amp; \max_{\boldsymbol{\theta} \in T(\delta)} \psi(\boldsymbol{\theta}) \leq 0.
	\end{aligned}
\end{equation}\]</div><p>This approach is illustrated with a traditional hyperbox set below.</p><p><img src="images/hyperbox_index.png" alt="sf_index"/></p><p>This approach is deterministic in nature; consequently, it does not have a direct probabilistic interpretation (as the <span>$SF$</span> index does). By transforming the inner problem in terms of its first order KKT conditions we obtain the following mixed integer formulation which is valid for any compact <span>$T(\delta)$</span>:</p><div>\[\begin{equation}
	\begin{aligned}
		&amp;F = &amp;\min_{\delta, \mathbf{z}, \mathbf{x}, \boldsymbol{\theta}, \lambda_j, s_j, y_j, \mu_j} &amp;&amp;&amp; \delta \\
		&amp;&amp;\text{s.t.} &amp;&amp;&amp; f_j(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta})+ s_j = 0 &amp;&amp; j \in J \\
		&amp;&amp;&amp;&amp;&amp; h_i(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) = 0 &amp;&amp; i \in I \\
		&amp;&amp;&amp;&amp;&amp; \sum_{j \in J} \lambda_j = 1 \\
		&amp;&amp;&amp;&amp;&amp; \sum_{j \in J} \lambda_j \frac{\partial f_j(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta})}{\partial \mathbf{z}} + \sum_{i \in I} \mu_i \frac{\partial h_i(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta})}{\partial \mathbf{z}}= 0 \\
		&amp;&amp;&amp;&amp;&amp; s_j \leq U(1 - y_j) &amp;&amp; j \in J \\
		&amp;&amp;&amp;&amp;&amp; \lambda_j \leq y_j &amp;&amp; j \in J \\
		&amp;&amp;&amp;&amp;&amp; \boldsymbol{\theta} \in T(\delta)  \\
		&amp;&amp;&amp;&amp;&amp; \lambda_j, s_j \geq 0 ; \ \ \ y_j \in \{0, 1\} &amp;&amp; j \in J.
	\end{aligned}
\end{equation}\]</div><p>This formulation can be rather tedious to implement and thus it what originally motivated the development of FlexJuMP. This MIP is what the <a href="api.html#FlexJuMP.solvehook"><code>solvehook</code></a> associated with the flexibility model <code>m</code> uses to compute the <span>$F$</span> index when the function <code>solve</code> is used.</p><h2><a class="nav-anchor" id="Uncertainty-Set-Characterization-1" href="#Uncertainty-Set-Characterization-1">Uncertainty Set Characterization</a></h2><p>Any compact set can be used to compute the flexibility index. The table below shows the 5 types FlexJuMP currently employs. Here <span>$\bar{\boldsymbol{\theta}}$</span> is the nominal point (mean), <span>$V_{\boldsymbol{\theta}}$</span> is the covariance matrix, and <span>$\Delta\boldsymbol{\theta}^-, \Delta\boldsymbol{\theta}^+$</span> are maximum lower and upper deviations, respectively. In FlexJuMP these sets are specified via <a href="api.html#FlexJuMP.setuncertaintyset"><code>setuncertaintyset</code></a>.</p><table><tr><th>Name</th><th>Uncertainty Set</th></tr><tr><td>Ellipsoidal Norm</td><td><span>$T_{ellip}(\delta) = \{\boldsymbol{\theta} : \lVert\boldsymbol{\theta} - \bar{\boldsymbol{\theta}}\rVert_{V_{\boldsymbol{\theta}}^{-1}}^2 \leq \delta \}$</span></td></tr><tr><td>Hyperbox Set</td><td><span>$T_{box}(\delta) = \{\boldsymbol{\theta} : \bar{\boldsymbol{\theta}} - \delta\Delta\boldsymbol{\theta}^- \leq \boldsymbol{\theta} \leq \bar{\boldsymbol{\theta}} + \delta\Delta\boldsymbol{\theta}^+\}$</span></td></tr><tr><td><span>$\ell_\infty$</span> Norm</td><td><span>$T_{\infty}(\delta) = \{\boldsymbol{\theta} : \lVert\boldsymbol{\theta} - \bar{\boldsymbol{\theta}}\rVert_\infty \leq \delta \}$</span></td></tr><tr><td><span>$\ell_1$</span> Norm</td><td><span>$T_{1}(\delta) = \{\boldsymbol{\theta} : \lVert\boldsymbol{\theta} - \bar{\boldsymbol{\theta}}\rVert_1 \leq \delta \}$</span></td></tr><tr><td><span>$\ell_2$</span> Norm</td><td><span>$T_{2}(\delta) = \{\boldsymbol{\theta} : \lVert\boldsymbol{\theta} - \bar{\boldsymbol{\theta}}\rVert_2 \leq \delta \}$</span></td></tr></table><p>We observe that <span>$T(\delta)$</span> can be represented by any combination of the uncertainty sets in the table above or other sets (provided that the resulting combined set is compact). This provides the ability to incorporate physical knowledge on the uncertain parameters and/or to create a wider range of uncertainty set shapes. For instance, the positive (truncated) ellipsoidal set <span>$T_{ellip+}(\delta) := T_{ellip}(\delta) \cap \mathbb{R}_+^{n_{\theta}}$</span>, where <span>$\mathbb{R}_+^{n_{\theta}} := \{\boldsymbol{\theta} : \boldsymbol{\theta} \geq 0\}$</span> can be used to represent parameters that are known to be non-negative (e.g., demands, prices). The in FlexJuMP the <code>only_positive</code> option enables the intersection of the sets mentioned above with the positive set <span>$\mathbb{R}_+^{n_{\theta}}$</span>.</p><p>One advantage of using <span>$T_{ellip}(\delta)$</span>  is that the associated flexibility index (denoted by <span>$F_{ellip}$</span>) can be used to obtain the confidence level:</p><div>\[\begin{equation}
	\alpha^* := \frac{\gamma(\frac{n_{\theta}}{2}, \frac{F_{ellip}}{2})}{\Gamma(\frac{n_{\theta}}{2})}
\end{equation}\]</div><p>where <span>$\gamma(\cdot)$</span> and <span>$\Gamma(\cdot)$</span> are the incomplete and complete gamma functions. Interestingly, this confidence level provides a lower bound for the stochastic flexibility index <span>$SF$</span> (i.e., <span>$\alpha^*\leq SF$</span>). This thus provides an avenue to obtain a probabilistic interpretation of the deterministic flexibility index while avoiding MC sampling. This confidence level can be obtained with the <a href="api.html#FlexJuMP.getconfidencelevel"><code>getconfidencelevel</code></a> function.</p><p>For flexibility analysis it is critical that <span>$\bar{\boldsymbol{\theta}}$</span> be feasible, thus the function [<code>ismeanfeasible</code>] is used to verify the mean&#39;s feasibility. In some applications, specifying <span>$\bar{\boldsymbol{\theta}}$</span> might be difficult if not enough data is available or if a system is not routinely operated at any given point (e.g., a power grid). Thus, we introduce methods that can be employed to find well-centered nominal points.</p><p>The analytic center <span>$\bar{\boldsymbol{\theta}}_{ac}$</span> can be defined by:</p><div>\[\begin{equation}
	\begin{aligned}
		&amp;{\bar{\boldsymbol{\theta}}}_{ac} \in &amp; \underset{\boldsymbol{\theta}, \mathbf{z}, \mathbf{x}, s}{\mathrm{argmax}} &amp;&amp;&amp; \sum_{j \in J} \log \left(s_j \right) \\
		&amp;&amp;\text{s.t.} &amp;&amp;&amp; f_j(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) +s_j\leq 0, &amp;&amp; j \in J \\
		&amp;&amp;&amp;&amp;&amp; h_i(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) = 0, &amp;&amp; i \in I.
	\end{aligned}
\end{equation}\]</div><p>Here, <span>$s_j\in \mathbb{R}$</span> are slack variables. This problems pushes the constraints to the interior of the feasible region and gives the analytic center as the point that maximizes the geometric mean of the constraints (slack variables). The feasible center <span>$\bar{\boldsymbol{\theta}}_{fc}$</span> is the point that maximizes the worst-case slack variable and is given by:</p><div>\[\begin{equation}
	\begin{aligned}
		&amp;\bar{\boldsymbol{\theta}}_{fc} \in &amp;\underset{\boldsymbol{\theta}, \mathbf{z}, \mathbf{x}, s}{\mathrm{argmax}} &amp;&amp;&amp; s \\
		&amp;&amp;\text{s.t.} &amp;&amp;&amp; f_j(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) + s \leq 0, &amp; j \in J \\
		&amp;&amp;&amp;&amp;&amp; h_i(\mathbf{z}, \mathbf{x}, \boldsymbol{\theta}) = 0, &amp; i \in I.
	\end{aligned}
\end{equation}\]</div><p>In FlexJuMP these centers can be computed using the <a href="api.html#FlexJuMP.findcenteredmean"><code>findcenteredmean</code></a> function.</p><h2><a class="nav-anchor" id="Analysis-Techniques-1" href="#Analysis-Techniques-1">Analysis Techniques</a></h2><p>The flexibility index is a valuable metric that can be used to compare system designs. The utility and interpretation of the index for a system will depend on the choice of <span>$T(\delta)$</span>. For instance, the index can be used to determine the confidence level <span>$\alpha^*$</span> if the set <span>$T_{ellip}(\delta)$</span> is used when <span>$\boldsymbol{\theta} ~ \sim \mathcal{N}(\bar{\boldsymbol{\theta}}, V_{\boldsymbol{\theta}})$</span>. The index might not have a clear interpretation or utility for some choices of <span>$T(\delta)$</span> but can still be useful to quantify improvements in flexibility from design modifications (retrofits). An example of comparing two systems with ellipsoidal and hyperbox sets is shown below.</p><p><img src="images/comparison.png" alt="comparison"/></p><p>It is apparent that Design B has a larger feasible region <span>$\Theta$</span> and thus has a larger <span>$SF$</span> index. Both sets reflect this behavior and could be used to make a comparison without having to compute the <span>$SF$</span> index. A key observation is that the choice of <span>$T(\delta)$</span> significantly affects how it measures system flexibility. For instance, for Design B, the ellipsoidal and hyperbox sets identify different limiting constraints, and thus exhibit distinct behavior. In particular, index <span>$F_{box}$</span> is limited by constraint <span>$f_2$</span> and would not change if constraints <span>$f_1$</span>, <span>$f_3$</span>, and/or <span>$f_4$</span> were varied to increase the area of <span>$\Theta$</span>, even though the overall system flexibility would be improved. On the other hand, index <span>$F_{ellip}$</span> is limited by constraint <span>$f_1$</span>. This conservative behavior parallels what is observed with the use of uncertainty sets in robust optimization, where such sets are used to optimize against the worst case scenario such that the solution is robust in the face of uncertainty, and the conservativeness of a solution depends on the chosen shape of the uncertainty set.</p><p>The flexibility index problem can also be used to rank constraints that most limit system flexibility, since it implicitly identifies constraints that limit flexibility. Specifically, at the solution of the flexibility index problem, the binary variables <span>$y_j$</span> indicate which constraints are active and therefore limit flexibility. Thus, the flexibility index problem can be resolved by excluding this first set of limiting constraints, so that the next set of limiting constraints can be identified. This step can be repeated to rank system constraints to a desired extent (as long as the solution of the problem is bounded). This is done by noticing that each set of limiting constraints will have an associated flexibility index, which indicates how limiting a particular set of constraints is relative to the other sets. This methodology can also be used to identify and rank system components that limit flexibility in order to guide design improvements or quantify value of specific components. Limiting constraint information can also be used to quantify the impact of failure of system components (e.g., a production facility). This process is illustrated in the figure below.</p><p><img src="images/ranking.png" alt="comparison"/></p><p>This shows how limiting (active) constraints are iteratively turned off to find subsequent limiting constraints. In FlexJuMP the function <a href="api.html#FlexJuMP.rankinequalities"><code>rankinequalities</code></a> automatically carries out this iterative methodology. Also, for a particular solved flexibility model <code>m</code>, the active constraint indexes can be retrieved via the <a href="api.html#FlexJuMP.getactiveconstraints"><code>getactiveconstraints</code></a> function.  </p><footer><hr/><a class="previous" href="index.html"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="guide.html"><span class="direction">Next</span><span class="title">User Guide</span></a></footer></article></body></html>
